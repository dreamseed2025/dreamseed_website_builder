<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete sitemap and page directory for DreamSeed platform with production readiness scores">
    <title>DreamSeed - Complete Sitemap & Page Directory</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .sitemap-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .sitemap-header {
            text-align: center;
            margin-bottom: 3rem;
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .sitemap-title {
            font-size: 3rem;
            margin: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .sitemap-subtitle {
            font-size: 1.2rem;
            color: #666;
            margin: 1rem 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin: 0.5rem 0 0 0;
        }
        
        .filters {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .filter-item select, .filter-item input {
            padding: 0.5rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }
        
        .category-section {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .category-section:hover {
            transform: translateY(-5px);
        }
        
        .category-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin: 0;
        }
        
        .category-stats {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .category-content {
            padding: 0;
        }
        
        .page-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #f3f4f6;
            transition: background 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-item:hover {
            background: #f9fafb;
        }
        
        .page-item:last-child {
            border-bottom: none;
        }
        
        .page-info {
            flex: 1;
        }
        
        .page-title {
            font-weight: 600;
            color: #1f2937;
            text-decoration: none;
            display: block;
            margin-bottom: 0.25rem;
        }
        
        .page-title:hover {
            color: #667eea;
        }
        
        .page-description {
            font-size: 0.8rem;
            color: #6b7280;
            margin: 0;
        }
        
        .page-path {
            font-size: 0.7rem;
            color: #9ca3af;
            font-family: monospace;
        }
        
        .page-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 0.5rem;
        }
        
        .score-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .score-excellent {
            background: #dcfce7;
            color: #166534;
        }
        
        .score-good {
            background: #fef3c7;
            color: #92400e;
        }
        
        .score-fair {
            background: #fed7aa;
            color: #9a3412;
        }
        
        .score-poor {
            background: #fecaca;
            color: #991b1b;
        }
        
        .feature-tags {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }
        
        .feature-tag {
            background: #e5e7eb;
            color: #374151;
            padding: 0.1rem 0.4rem;
            border-radius: 8px;
            font-size: 0.6rem;
        }
        
        .feature-tag.has {
            background: #d1fae5;
            color: #065f46;
        }
        
        .issues-list {
            margin-top: 0.5rem;
            font-size: 0.7rem;
            color: #ef4444;
        }
        
        .last-updated {
            text-align: center;
            margin-top: 3rem;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .sitemap-container {
                padding: 1rem;
            }
            
            .sitemap-title {
                font-size: 2rem;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .page-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .page-meta {
                align-items: flex-start;
                flex-direction: row;
                justify-content: space-between;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation will be injected here -->
    
    <div class="sitemap-container">
        <div class="sitemap-header">
            <h1 class="sitemap-title">üó∫Ô∏è Complete Sitemap</h1>
            <p class="sitemap-subtitle">Comprehensive directory of all pages with production readiness scores</p>
            
            <div class="stats-grid" id="stats-grid">
                <!-- Stats will be populated by JavaScript -->
            </div>
        </div>
        
        <div class="filters">
            <div class="filter-item">
                <label for="category-filter">Category:</label>
                <select id="category-filter" onchange="filterPages()">
                    <option value="all">All Categories</option>
                </select>
            </div>
            
            <div class="filter-item">
                <label for="status-filter">Status:</label>
                <select id="status-filter" onchange="filterPages()">
                    <option value="all">All Status</option>
                    <option value="ready">üü¢ Production Ready (8+)</option>
                    <option value="good">üü° Good Quality (6-7)</option>
                    <option value="fair">üü† Needs Work (4-5)</option>
                    <option value="poor">üî¥ Issues (<4)</option>
                </select>
            </div>
            
            <div class="filter-item">
                <label for="search-filter">Search:</label>
                <input type="text" id="search-filter" placeholder="Search pages..." onkeyup="filterPages()">
            </div>
            
            <div class="filter-item">
                <label for="sort-filter">Sort by:</label>
                <select id="sort-filter" onchange="filterPages()">
                    <option value="score">Production Score</option>
                    <option value="name">Page Name</option>
                    <option value="category">Category</option>
                    <option value="modified">Last Modified</option>
                </select>
            </div>
        </div>
        
        <div class="categories-grid" id="categories-grid">
            <!-- Categories will be populated by JavaScript -->
        </div>
        
        <div class="last-updated" id="last-updated">
            <!-- Last updated info will be populated by JavaScript -->
        </div>
    </div>

    <script src="/components/unified-header.js"></script>
    <script>
        let siteData = null;
        let filteredData = null;

        async function loadSiteData() {
            try {
                const response = await fetch('/site-analysis.json');
                siteData = await response.json();
                filteredData = { ...siteData };
                
                populateStats();
                populateFilters();
                renderCategories();
                updateLastModified();
            } catch (error) {
                console.error('Failed to load site data:', error);
                showFallbackMessage();
            }
        }

        function populateStats() {
            const stats = [
                {
                    value: siteData.totalPages,
                    label: 'Total Pages'
                },
                {
                    value: siteData.pages.filter(p => p.productionScore >= 8).length,
                    label: 'Production Ready'
                },
                {
                    value: Object.keys(siteData.categories).length,
                    label: 'Categories'
                },
                {
                    value: Math.round((siteData.pages.filter(p => p.productionScore >= 6).length / siteData.totalPages) * 100) + '%',
                    label: 'Quality Score'
                }
            ];

            const statsGrid = document.getElementById('stats-grid');
            statsGrid.innerHTML = stats.map(stat => `
                <div class="stat-card">
                    <div class="stat-value">${stat.value}</div>
                    <div class="stat-label">${stat.label}</div>
                </div>
            `).join('');
        }

        function populateFilters() {
            // Populate category filter
            const categoryFilter = document.getElementById('category-filter');
            Object.keys(siteData.categories).forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        function renderCategories() {
            const categoriesGrid = document.getElementById('categories-grid');
            
            const categories = Object.entries(filteredData.categories).map(([name, pages]) => {
                const productionReady = pages.filter(p => p.productionScore >= 8).length;
                const avgScore = Math.round(pages.reduce((sum, p) => sum + p.productionScore, 0) / pages.length);
                
                return {
                    name,
                    pages,
                    productionReady,
                    total: pages.length,
                    avgScore
                };
            });

            categoriesGrid.innerHTML = categories.map(category => `
                <div class="category-section">
                    <div class="category-header">
                        <h3 class="category-title">
                            ${getCategoryIcon(category.name)} ${category.name}
                        </h3>
                        <div class="category-stats">
                            ${category.productionReady}/${category.total} ready
                            <br>Avg: ${category.avgScore}/10
                        </div>
                    </div>
                    <div class="category-content">
                        ${category.pages.map(page => `
                            <div class="page-item">
                                <div class="page-info">
                                    <a href="${page.relativePath}" class="page-title">${page.title}</a>
                                    <p class="page-description">${page.description}</p>
                                    <div class="page-path">${page.relativePath}</div>
                                    ${page.issues.length > 0 ? `<div class="issues-list">Issues: ${page.issues.join(', ')}</div>` : ''}
                                    <div class="feature-tags">
                                        ${renderFeatureTags(page.features)}
                                    </div>
                                </div>
                                <div class="page-meta">
                                    <div class="score-badge ${getScoreClass(page.productionScore)}">
                                        ${page.productionScore}/10
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function renderFeatureTags(features) {
            const tags = [];
            if (features.hasSupabase) tags.push('<span class="feature-tag has">Supabase</span>');
            if (features.hasVAPI) tags.push('<span class="feature-tag has">VAPI</span>');
            if (features.hasAuth) tags.push('<span class="feature-tag has">Auth</span>');
            if (features.isResponsive) tags.push('<span class="feature-tag has">Responsive</span>');
            if (features.hasNavigation) tags.push('<span class="feature-tag has">Navigation</span>');
            if (!features.hasCSS) tags.push('<span class="feature-tag">No CSS</span>');
            if (!features.hasJS) tags.push('<span class="feature-tag">No JS</span>');
            return tags.join('');
        }

        function getCategoryIcon(category) {
            const icons = {
                'Home': 'üè†',
                'Voice/VAPI': 'üé§',
                'Dashboards': 'üìä',
                'Authentication': 'üîê',
                'Customer': 'üë§',
                'Admin': 'üëë',
                'Testing/Debug': 'üîß',
                'Public Pages': 'üåê',
                'Other': 'üìÑ'
            };
            return icons[category] || 'üìÑ';
        }

        function getScoreClass(score) {
            if (score >= 8) return 'score-excellent';
            if (score >= 6) return 'score-good';
            if (score >= 4) return 'score-fair';
            return 'score-poor';
        }

        function filterPages() {
            const categoryFilter = document.getElementById('category-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            const searchFilter = document.getElementById('search-filter').value.toLowerCase();
            const sortFilter = document.getElementById('sort-filter').value;

            // Filter pages
            let filteredPages = siteData.pages.filter(page => {
                // Category filter
                if (categoryFilter !== 'all' && page.category !== categoryFilter) return false;
                
                // Status filter
                if (statusFilter !== 'all') {
                    if (statusFilter === 'ready' && page.productionScore < 8) return false;
                    if (statusFilter === 'good' && (page.productionScore < 6 || page.productionScore >= 8)) return false;
                    if (statusFilter === 'fair' && (page.productionScore < 4 || page.productionScore >= 6)) return false;
                    if (statusFilter === 'poor' && page.productionScore >= 4) return false;
                }
                
                // Search filter
                if (searchFilter && !page.title.toLowerCase().includes(searchFilter) && 
                    !page.description.toLowerCase().includes(searchFilter) &&
                    !page.category.toLowerCase().includes(searchFilter)) return false;
                
                return true;
            });

            // Sort pages
            filteredPages.sort((a, b) => {
                switch (sortFilter) {
                    case 'name':
                        return a.title.localeCompare(b.title);
                    case 'category':
                        return a.category.localeCompare(b.category);
                    case 'modified':
                        return new Date(b.lastModified) - new Date(a.lastModified);
                    case 'score':
                    default:
                        return b.productionScore - a.productionScore;
                }
            });

            // Group filtered pages by category
            const filteredCategories = {};
            filteredPages.forEach(page => {
                if (!filteredCategories[page.category]) {
                    filteredCategories[page.category] = [];
                }
                filteredCategories[page.category].push(page);
            });

            filteredData = {
                ...siteData,
                categories: filteredCategories,
                pages: filteredPages
            };

            renderCategories();
        }

        function updateLastModified() {
            const lastUpdated = document.getElementById('last-updated');
            lastUpdated.innerHTML = `
                Last updated: ${new Date(siteData.generatedAt).toLocaleString()}
                <br>
                <small>This sitemap is automatically updated on every commit</small>
            `;
        }

        function showFallbackMessage() {
            document.getElementById('categories-grid').innerHTML = `
                <div style="text-align: center; padding: 3rem; color: #666;">
                    <h3>Site analysis not available</h3>
                    <p>Run <code>node analyze-pages.js</code> to generate the site analysis data.</p>
                </div>
            `;
        }

        // Initialize on page load
        loadSiteData();
    </script>
</body>
</html>